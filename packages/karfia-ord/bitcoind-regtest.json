{
  "$schema": "https://raw.githubusercontent.com/fuxingloh/karfia/main/packages/karfia-definition/index.json",
  "id": "bip122:0f9188f13cb7b2c71f2a335e3a4fc328/bitcoind:25.1",
  "caip2": "bip122:0f9188f13cb7b2c71f2a335e3a4fc328",
  "name": "Bitcoin Regtest",
  "environment": {
    "BITCOIND_RPC_USER": {
      "type": "Value",
      "value": "user"
    },
    "BITCOIND_RPC_PASSWORD": {
      "type": "Value",
      "value": "pass"
    }
  },
  "containers": {
    "bitcoind": {
      "image": "docker.io/kylemanna/bitcoind@sha256:1492fa0306cb7eb5de8d50ba60367cff8d29b00b516e45e93e05f8b54fa2970e",
      "source": "https://github.com/kylemanna/docker-bitcoind",
      "command": ["btc_oneshot", "-fallbackfee=0.00000200", "-rpcbind=:8332", "-rpcallowip=0.0.0.0/0"],
      "endpoints": {
        "p2p": {
          "port": 18445
        },
        "rpc": {
          "port": 8332,
          "protocol": "HTTP JSON-RPC 2.0",
          "authorization": {
            "type": "HttpBasic",
            "username": {
              "key": "RPC_USER"
            },
            "password": {
              "key": "RPC_PASSWORD"
            }
          },
          "probes": {
            "readiness": {
              "method": "getblockchaininfo",
              "params": [],
              "match": {
                "result": {
                  "type": "object",
                  "properties": {
                    "blocks": {
                      "type": "number"
                    }
                  },
                  "required": ["blocks"]
                }
              }
            }
          }
        }
      },
      "resources": {
        "cpu": 0.25,
        "memory": 256
      },
      "environment": {
        "REGTEST": "1",
        "RPCUSER": {
          "key": "BITCOIND_RPC_USER"
        },
        "RPCPASSWORD": {
          "key": "BITCOIND_RPC_PASSWORD"
        }
      },
      "volumes": {
        "persistent": {
          "paths": ["/bitcoin/.bitcoin"],
          "size": "250M"
        }
      }
    },
    "ord": {
      "image": "ghcr.io/fuxingloh/karfia-ord:0.18.5",
      "source": "https://github.com/fuxingloh/karfia-ord",
      "endpoints": {
        "api": {
          "port": 8080,
          "protocol": "HTTP REST",
          "probes": {
            "readiness": {
              "method": "GET",
              "path": "/status",
              "match": {
                "status": 200
              }
            }
          }
        }
      },
      "resources": {
        "cpu": 0.25,
        "memory": 256
      },
      "environment": {
        "ORD_CHAIN": "regtest",
        "ORD_BITCOIN_HOST_PORT": "bitcoind:8332",
        "ORD_BITCOIN_RPC_URL": "http://bitcoind:8332",
        "ORD_BITCOIN_RPC_USERNAME": {
          "key": "BITCOIND_RPC_USER"
        },
        "ORD_BITCOIN_RPC_PASSWORD": {
          "key": "BITCOIND_RPC_PASSWORD"
        }
      }
    }
  }
}
